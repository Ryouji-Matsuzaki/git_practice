## 組み込み関数
### 日付編

### ■組み込み関数

PHPでは、良く使う機能などを組み込み関数として用意してくれています。

全ての処理を自力で書いても良いのですが、それではプログラミングに非常に時間が掛かります。
また、不具合発生の要因にもなります。

組み込み関数を利用し、効率的な開発を行いましょう。

ここでは、日付に関する組み込み関数をご紹介します。

### ■日付処理

PHPで日付の情報を扱う場合、文字列としての管理か、タイムスタンプ(timestamp)と呼ばれる形での管理を行う事になります。

タイムスタンプとは、ある日付以降の総秒（経過時間を秒で表現した数字）を管理するものです。

** タイムスタンプの作成（mktime関数）：**

* 変数 = mktime(時, 分, 秒, 月, 日, 年);


```php
<?php

// 2017年11月9日 18時23分12秒のタイムスタンプ
$stamp = mktime(18, 23, 12, 11, 9, 2017);

// タイプスタンプを表示
// 「1510248192」と秒数で表示されます
echo $stamp;

```

タイムスタンプで日付の管理はできますが、表示しても人間には日付を理解できません。

そこで、タイムスタンプを人間にもわかる文字に変換する関数が用意されています。

** タイムスタンプの文字列化（date関数）：**

* 当日を文字で取得

  * 変数 = date(日付の書式);


* タイムスタンプの日付を文字で取得

  * 変数 = date(日付の書式, タイムスタンプ);

```php
<?php

// 今日の日付を、年/月/日 時:分:秒で取得
$today = date('Y/m/d H:i:s');
// 当日が表示されます
echo $today;

// 先ほどのタイムスタンプを年-月-日 時分秒で取得
$stamp = mktime(18, 23, 12, 11, 9, 2017);
$hiduke = date('Y-m-d His', $stamp);
// 2017-11-09 182312と表示されます。
echo $hiduke;

```

date関数を利用すると、タイムスタンプを文字にする事はできました。しかし、書式で指定した形で取得するため、年、月、日、などをバラバラで利用できません。

そこで、年、月、日などの情報をバラバラで取得する関数も用意されています。

** 日付情報をバラバラで取得（getdate関数）：**

* 当日の情報をバラバラで取得

  * 変数 = getdate();


* タイムスタンプの情報をバラバラで取得

  * 変数 = getdate(タイムスタンプ);


```php
<?php
// 当日をバラバラで取得
$arr_today = getdate();
// var_dumpを使って、$arr_todayの中を見てみましょう
// 連想配列になっているのがわかります
var_dump($arr_today);

// 先ほどのタイムスタンプをバラバラで取得
$stamp = mktime(18, 23, 12, 11, 9, 2017);
$arr_stamp = getdate($stamp);
// 月の表示
echo $arr_stamp['mon'];
// その年の経過日数を表示
echo $arr_stamp['yday'];
```

### ■文字列から日付へ

dateやgetdateで、日付を文字に変換する事はできましたが、日付の計算を行う場合は、タイムスタンプで行います。

そのため、文字の日付情報からタイムスタンプに変換をする必要もあります。

** 文字のタイムスタンプ化（strtotime関数）：**

* 現在日時に対する操作の場合

  * 変数 = strtotime(操作文字列);


* 特定日時に対する操作の場合

  * 変数 = strtotime(文字の日付情報);

```php
<?php

// 今日のタイムスタンプを取得
$stamp1 = strtotime('now');
// タイムスタンプの確認
echo $stamp1;

// 文字の日付情報からタイムスタンプを取得
$stamp2 = strtotime('2017-08-30 08:30:22');
// タイムスタンプの確認
echo $stamp2;

```

### ■日時の増減

ここまでは日時を作成して、持って回るだけでしたが、実際には日付の加算/減算などが必要になる場合があります。

タイムスタンプ自体が総秒なので、自分が増減したい時間の総秒を計算し、直接計算する事は可能です。

また、別の方法としてstrtotimeを利用して、日付の計算をさせる事も可能です。

** strtotimeによる日付の計算： **

変数 = strtotime(操作文字列, タイムスタンプ);


```php
<?php
// 今日の文字列を取得
$today = date('Y/m/d H:i:s');

// 計算により、明日のタイムスタンプを取得
// 文字の日時をタイムスタンプに変換
$tomorrow_stamp = strtotime($today);
// 24時間の総秒を加算
$tomorrow_stamp += 24 * 60 * 60;

// strtotimeで、明日のタイムスタンプを取得
$asita_stamp = strtotime('+1 day', strtotime($today));

// 両方表示
echo $tomorrow_stamp;
echo $asita_stamp;

```
